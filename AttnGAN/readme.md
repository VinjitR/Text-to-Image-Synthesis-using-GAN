# AttnGAN

Pytorch implementation for reproducing AttnGAN results in the paper [AttnGAN: Fine-Grained Text to Image Generation
with Attentional Generative Adversarial Networks](https://arxiv.org/pdf/1711.10485.pdf). 



### Dependencies
python 3.8.5

Pytorch

In addition, please add the project folder to PYTHONPATH and `pip install` the following packages:
- `python-dateutil`, `easydict`, `pandas`, `torchfile`, `nltk`, `scikit-image`


**Data**

- Download metadata (text and filename):
  - Download preprocessed metadata for [coco](https://drive.google.com/open?id=1rSnbIGNDGZeHlsUlLdahj0RJ9oo6lgH9) and save them to `data/`
  - Extract caption files in ''train2014-text.zip'' and ''val2014-text.zip'' to `data/coco/text/`
  - [**Optional**] If you want to use the per-trained models, please download the dictionary, **captions.pickle**, otherwise it will be generated by `pretrain_DAMSM.py`.
  

- Download images:
  - Download [coco](http://cocodataset.org/#download) dataset and extract both `train2014` and `val2014` images to `data/coco/images/`



**Training**
- Pre-train DAMSM models:
  - For coco dataset: `python pretrain_DAMSM.py --cfg cfg/DAMSM/coco.yml --gpu 0`
  
 
- Train AttnGAN models:
  - For coco dataset: `python main.py --cfg cfg/coco_attn2.yml --gpu 0`

- `*.yml` files are example configuration files for training/evaluation our models.





**Sampling**
- Run `python main.py --cfg cfg/eval_coco.yml --gpu 1` to generate examples from captions in files listed in "./data/coco/example_filenames.txt". Results are saved to `DAMSMencoders/`. 
- Change the `eval_*.yml` files to generate images from other pre-trained models. 
- Input your own sentence in "./data/coco/example_captions.txt" if you wannt to generate images from customized sentences. 

**Generation**
- Check gensample.txt

**Validation**
- To generate images for all captions in the validation dataset, change B_VALIDATION to True in the eval_*.yml. and then run `python main.py --cfg cfg/eval_coco.yml --gpu 1`
- We compute inception score for models  [improved-gan/inception_score](https://github.com/openai/improved-gan/tree/master/inception_score).
- We compute FID score for models [mseitzer/pytorch-fid](https://github.com/mseitzer/pytorch-fid)
- @misc{Seitzer2020FID,
  author={Maximilian Seitzer},
  title={{pytorch-fid: FID Score for PyTorch}},
  month={August},
  year={2020},
  note={Version 0.1.1},
  howpublished={\url{https://github.com/mseitzer/pytorch-fid}},
}
